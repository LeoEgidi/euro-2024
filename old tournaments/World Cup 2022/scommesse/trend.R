
# strategia 'Universit?"

df <- data.frame(match = c("Qatar-Ecuador", "England-Iran", "Senegal-Netherlands",
                           "Argentina Saudi-Arabia", "Denmark-Tunisia", "United States-Wales",
                           "Messico-Polonia", "France-Australia", "Germany-Japan",
                           "Morocco-Croatia", "Spain-Costa Rica", "Spain-Costa Rica",
                           "Portugal-Ghana", "Brazil-Serbia",
                           "Spain-Costa Rica", "Spain-Costa Rica", "Spain-Costa Rica",
                           "Belgium-Canada", "Belgium-Canada", "Belgium-Canada",
                           "Uruguay-South Korea",
                           "Switzerland-Cameroon", "Switzerland-Cameroon", "Switzerland-Cameroon",
                           "Uruguay-South Korea", "Uruguay-South Korea",
                           "Portugal-Ghana", "Brazil-Serbia",
                           "combinata Portugal-Brazil",
                           "Wales-Iran","Wales-Iran", "Wales-Iran",
                           "Qatar-Senegal", "Qatar-Senegal", "Qatar-Senegal", "Qatar-Senegal", "Qatar-Senegal",
                           "Netherlands-Ecuador", "Netherlands-Ecuador", "Netherlands-Ecuador", "Netherlands-Ecuador",
                           "England-USA", "England-USA", "England-USA", "England-USA",
                           "Tunisia-Australia", "Tunisia-Australia", "Tunisia-Australia", "Tunisia-Australia",
                           "Poland-Saudi Arabia", "Poland-Saudi Arabia","Poland-Saudi Arabia","Poland-Saudi Arabia",
                           "France-Denmark", "France-Denmark", "France-Denmark",
                           "Argentina-Mexico", "Argentina-Mexico", "Argentina-Mexico",
                           "Japan-Costa Rica", "Japan-Costa Rica", "Japan-Costa Rica", "Japan-Costa Rica", "Japan-Costa Rica", "Japan-Costa Rica",
                           "Belgium-Morocco", "Belgium-Morocco", "Belgium-Morocco", "Belgium-Morocco",
                           "Croatia-Canada", "Croatia-Canada", "Croatia-Canada", "Croatia-Canada",
                            "Spain-Germany", "Spain-Germany", "Spain-Germany", "Spain-Germany",
                           "Cameroon-Serbia", "Cameroon-Serbia", "Cameroon-Serbia",
                           "Multipla_28_11",
                           "South Korea-Ghana", "South Korea-Ghana", "South Korea-Ghana",
                           "Brazil-Switzerland", "Brazil-Switzerland", "Brazil-Switzerland", "Brazil-Switzerland",
                           "Portugal-Uruguay", "Portugal-Uruguay", "Portugal-Uruguay",
                           "Ecuador-Senegal", "Ecuador-Senegal", "Ecuador-Senegal", 
                           "Netherlands-Qatar", "Netherlands-Qatar",
                           "Wales-England", "Wales-England", "Wales-England", "Wales-England", "Wales-England","Wales-England",
                           "Iran-United States", "Iran-United States", "Iran-United States", "Iran-United States", "Iran-United States",
                           "France-Tunisia", "France-Tunisia", "France-Tunisia",
                           "Australia-Denmark", "Australia-Denmark", "Australia-Denmark", "Australia-Denmark",
                           "Argentina-Poland", "Argentina-Poland", "Argentina-Poland", "Argentina-Poland",
                           "Mexico-Saudi Arabia",
                           "Morocco-Canada", "Morocco-Canada", "Morocco-Canada", "Morocco-Canada","Morocco-Canada",
                           "Combinata belgio-giappone", 
                           "Croatia-Belgium", "Croatia-Belgium", "Croatia-Belgium",
                           "Germany-Costa Rica", "Germany-Costa Rica", "Germany-Costa Rica", "Germany-Costa Rica", "Germany-Costa Rica",
                           "Spain-Japan", "Spain-Japan", "Spain-Japan", "Spain-Japan",
                           "Portugal-South Korea", "Portugal-South Korea", "Portugal-South Korea", "Portugal-South Korea",
                           "Brazil-Cameroon", "Brazil-Cameroon", "Brazil-Cameroon",
                           "Uruguay-Ghana","Uruguay-Ghana", "Uruguay-Ghana", 
                           "Serbia-Switzerland", "Serbia-Switzerland", "Serbia-Switzerland", "Serbia-Switzerland", "Serbia-Switzerland",
                           "Netherlands-USA", "Netherlands-USA", "Netherlands-USA", "Netherlands-USA",
                           "Argentina-Australia", "Argentina-Australia", "Argentina-Australia", "Argentina-Australia",
                           "France-Poland", "France-Poland", "France-Poland", "France-Poland","France-Poland",
                           "combinata_FraEng",
                           "England-Senegal", "England-Senegal",
                           "Japan-Croatia", "Japan-Croatia",
                           "Brazil-South Korea", "Brazil-South Korea", "Brazil-South Korea",
                           "Portugal-Switzerland","Portugal-Switzerland", "Portugal-Switzerland","Portugal-Switzerland",
                           "Spain-Morocco", "Spain-Morocco", "Spain-Morocco", "Spain-Morocco",
                           "Combinata",
                           "England-France",
                           "Portugal-Morocco","Portugal-Morocco",
                           "Argentina-Netherlands", 
                           "Brazil-Croatia", "Brazil-Croatia",
                           "France-Morocco",
                           "Argentina-Croatia",
                           "1-0 France", "1-0 ACrgentina", "Arg-X", "Finale Cro-Mar",
                           "Argentina campione", "Morocco campione",
                           "Varie"
                           ),
                           
                 esito = c(1,0,1,
                           0,0,0,
                           0,0, 1,
                           0, 0, 0,
                           1, 1,
                           0, 0, 0,
                           0, 0, 1,
                           0,
                           1,0,0,
                           0,1,0, 1,1,
                           1, 0,0,
                           0,0,0,0,0,
                           0, 0,0,1,
                           1,0,1,0,
                           1,0,0,0,
                           0,0,0,0,
                           0,0,0,
                           0,0,1,
                           0,1,0,0,0,0,
                           0,0,0,0,
                           1 ,0,0,0,
                           0,0,1,0,
                           1, 0,0,
                           0,
                           0,0,0,
                           1,1,0,0,
                           0,0,0,
                           1,0,1,
                           0,0,
                           0,0,0,0,0,0,
                           0,0,0,0,1,
                           0,0,0,
                           0,1,0,0,
                           0,0,0,1,
                           0,
                           0,1,0,0,0,
                           0,
                           0,0,0,
                           0,0,0,0,0,
                           0,0,0,1,
                           0,0,0,1,
                           0,0,0,  
                           1,0,1,
                           1,0,0,0,0,
                           1,0,0,0,
                           0,0,0,0,
                           1, 0,0,0, 0,
                           1,
                           0,0,
                           1,0,
                           0,0,0,
                           0,0,0,0,
                           0,0,0,1,
                           0,
                           0,
                           1,0,
                           0, 
                           1,0,
                           0,1,
                           0,0,0,0,
                           1,0,
                           0),
                 puntata1 = c("2", "2", "2",
                              "X", "1-0", "1",
                              "1", "1-0", "2",
                              "1", "2", "X2",
                              "1", "1",
                              NA, NA, NA,
                              NA, NA, NA,
                              "2",
                              NA, NA, NA,
                              NA, NA,
                              NA, NA,
                              "11",
                              "2", NA, NA,
                              "1", "X", "0-1", "0-2", "0-0",
                              "1", NA, NA, NA,
                              "X", "2", "0-0", "1-0",
                              "2","X", "0-0", "1-0",
                              "X2", "0-0", "1-0", "2",
                              "X", "2", "2-0",
                              "X", "1-0", NA,
                              "X","2", "0-0", NA, NA, NA,
                              "1", "1-0","0-1", NA,
                              "1", "1-0", NA, NA,
                              "1", "1-0", NA, "0-1",
                              "X", NA, NA,
                              "multipla",
                              "1", "1-0", NA,
                              "1", "1-0", "2-0", "3-0",
                              "2", NA, NA,
                              "2", "0-1", "gol & gol",
                              "X", "2",
                              "1", "X", "0-1", NA, NA, NA,
                              "1", "1-0", NA, NA, NA,
                              "1", "1-0", NA,
                              "X", "1", "0-1", NA,
                              "1-0", "Over1.5 & Poland", NA, NA,
                              "secchi",
                              "0-0", "1", NA, NA, NA, 
                              "combinata",
                              "2", NA, "0-1",
                              "1-0", "2-0", "3-0", NA, "2",
                              "1-0", "2-0", "X", NA,
                              "1", "1-0", NA, "2",
                              "1", "1-0", "2-0",
                              "1", "1-0", NA,
                              "2", "0-1", NA, NA, NA,
                              "1", "1-0", "0-0", "1-1",
                              "1-0", "X", "2-0", "2",
                              "1 (1t)", "2", "1-0", NA, NA,
                              "FraEng",
                              "1-0", NA,
                              "1-1", "Altre",
                              "X", "1-0", "2-0",
                              "1-0", "X", "2", NA,
                              "2", "1-0", NA, NA,
                              "Comb",
                              "Varie",
                              "2", "Varie",
                              "Varie",
                              NA, "Varie",
                              "2", 
                              "1",
                              "1-0 France", "1-0 Argentina", "Arg-X", "Finale Cro-Mar",
                              "Argentina campione", NA,
                              "Varie"
                              ), # univ
                 puntata2 = c("2", "2", "2",
                              "X", "1-0", "1",
                              "1", "1-0", "2",
                              "1", "2",
                              "1", "1",
                              "1-1", "2-0", "1-0",
                              "1-1", "2-0", "1-0",
                               "1", "1",
                              "1-0", "0-0", "1-1",
                              "1-0", "0-0",
                              "2-0", "2-0",
                              NA, 
                              "2", "1-0", "0-0",
                              "1", NA, "0-1", "0-2", "0-0",
                              "1", "1-0", "0-0", "1-1",
                              "X", "2", "0-0", "1-0",
                              "2", "X", "0-0", "1-0",
                              "X2", "0-0", "1-0", "2",
                              "X", "2", "2-0",
                              "X", "1-0", "2-0",
                              NA, NA, NA, "1-0", "2-0", "3-0",
                              "1", "1-0", NA, "1-1",
                              NA, "1-0", "0-0", "1-1",
                              "1", "1-0", "1-1", NA,
                              "X", "1-0", "2-0",
                              NA,
                              "1", "1-0", "0-0",
                              "1", "1-0", "2-0", NA,
                              "2", "1-0", "1-1",
                              NA, NA, NA,
                              NA, NA,
                              NA, NA, "0-1", "1-1", "0-2", "1-0",
                              NA, "1-0", "0-0", "1-1", "0-1",
                              "1", "1-0", "2-0",
                              "X", NA, "0-1", "0-2",
                              "1-0", NA, "2-0", "1-1",
                              "secchi",
                              NA, NA, "1-1", "1-0", "2",
                              NA,
                              "2", "1-1", "0-1", 
                              "1-0", "2-0", NA, "X", "2",
                              "1-0", NA, NA, "2",
                              NA, "1-0", "2-0", "2",
                              "1", "1-0", "2-0",
                              "1", "1-0", "2-0",
                              NA, NA, "0-0", "1-1", "1-0",
                              NA, "1-0", "0-0", "1-1",
                              "1-0", "X", "2-0", "2",
                              NA, "2", "1-0", "2-0","X",
                              NA,
                              "1-0", "2-0",
                              "1-1", "Altre",
                              "X", "1-0", "2-0",
                              "1-0", NA, "2", "1-1",
                              NA, "1-0", "2-0", "X",
                              NA,
                              "Varie",
                              NA, "Varie",
                              "Varie",
                              "X", "Varie",
                              NA, NA,
                              NA, NA, NA, NA,
                              "Arg camp", "Marocco camp",
                              NA
                              ), # sistemone
                 giocato1 = c(12, 6, 12,
                              6, 3,  12,
                              12, 3, 6,
                              6, 3, 6,
                              12,12,
                              NA, NA, NA,
                              NA, NA, NA,
                              6,
                              NA, NA, NA,
                              NA,NA,
                              NA, NA,6,
                              6, NA, NA,
                              6,6, NA, NA, NA,
                              30, NA, NA, NA,
                              10, 5, NA, NA,
                              5, 10, 3, NA,
                              15, 3, NA, NA,
                              5,10, NA,
                              5,10, NA,
                              10, 5, 3, NA, NA,NA,
                              30,3,3, NA,
                              10, 5, NA, NA,
                              15,3,NA, 3,
                              5, NA, NA,
                              4,
                              30, 3, NA,
                              30, 5, 5, 5,
                              15, NA, NA,
                              6, 3,1,
                              3,3,
                              3,6,3, NA, NA, NA,
                              6,1, NA, NA, NA,
                              30, 2, NA,
                              3,3,2, NA,
                              2,2, NA, NA,
                              10,
                              2,10, NA, NA, NA,
                              15,
                              10, NA, 2,
                              2,1,1,NA, 2,
                              2,1,3, NA,
                              20,3, NA, NA,
                              30,3,3,
                              20,3, NA,
                              20,3, NA, NA, NA,
                              20,3, NA, NA,
                              5,3,NA, NA,
                              40, 5, 3, NA, NA,
                              20,
                              3, NA,
                              2, 20,
                              5,2,2,
                              3,7,4,NA,
                              4,3,NA, NA,
                              10,
                              53,
                              5,40,
                              8, 
                              NA, 11,
                              20, 30,
                              5,5,5,5,
                              20, NA,
                              101.76
                              ),
                 giocato2 = c(NA, NA, 12, 12, 6,
                              3, 7,4,
                              6, 6 , 3, NA,
                              12, 12,
                              2,3,3,
                              3,3,3,
                              7,
                              3,3,3,
                              3,4,
                              2,2,
                              NA,
                              6,3,3,
                              6,5, 3,3,3,
                              7, 2,2,2,
                              NA,5,3,3,
                              6, NA,3, 3,
                              NA, 3, 3, 6,
                              4,6,3,
                              5,3,2,
                              NA,NA, NA, 3,3,3,
                              9, 3,NA,2, 
                              NA, 3,3,3,
                              9, 3,3, NA,
                              4, 3, 3,
                              NA,
                              8,3,3,
                              10,3,3, NA,
                              7,3,3,
                              NA, NA, NA,
                              NA, NA,
                              NA, NA, 3,3, 3,3,
                              NA, 2, 3,2,3,
                              10, 3,3,
                              5, NA, 3,3,
                              3, NA, 3,3,
                              12,
                              NA, NA, 3,3,6,
                              NA,
                              8,3,3,
                              3,2, NA, 2, 1.5,
                              3,NA, NA,3,
                              NA, 3,3,3,
                              8,3,3,
                              8,3,3,
                              NA, 3,3,3,3, 
                              NA, 5,3,3,
                              5,3,3,3,
                              NA, 3, 8,6,4,
                              NA,
                              8,7,
                              5,15,
                              4,5,5,
                              5, NA, 4,5,
                              NA, 5,5,4,
                              NA,
                              24,
                              NA, 19,
                              17,
                              5,15,
                              NA, NA,
                              NA, NA, NA, NA,
                              180,40,
                              NA
                              ),
                 quota =   c(2.25, 10, 1.57,
                            7, 13, 2.45,
                            2.7, 5, 6.75,
                            4, 17, 5.5,
                            1.4, 1.46,
                            19, 6, 8,
                            8.5, 8, 8,
                            5.5,
                            6,7,7,
                            7.5, 6,
                            6.5, 7.5,
                            3.4,
                            3.8, 6.5, 7,
                            5.7, 3.75, 7, 5.5, 7,
                            1.8, 7,6,7,
                            4.3, 6.5,10,7,
                            3.6, 3.25, 8, 7,
                            1.93, 7,6.5, 5,
                            3.75, 4.75,8,
                            4,6.6,7,
                            3.5,6.75, 6,6,6.5,10,
                            2,7,10,7,
                            2.2, 8.5, 9.5, 7,
                            2.25, 11, 7.5, 7,
                            3.75, 6.5, 7.5,
                            2.5,
                            2.6, 8,7,
                            1.57, 4, 5.5, 7,
                            4.2, 6.5, 7,
                            3.1, 5, 8.5,
                            5,17,
                            8.25, 4.5, 5.5,9, 6.5, 17,
                            3.9,10,  7.5, 7, 6.5,
                            1.65, 6.5, 7.5, 
                            2.80,7, 7,7,
                            6, 7, 6.5, 8.5,
                            6.5,
                            8, 1.83, 8,7,4.75,
                            11.79, 
                            2.62, 7,9,
                            7,11,8,11, 26,
                            7, 7,7,7,
                            1.7, 6.5,5.5, 9, 
                            1.36, 7.5,7,
                            1.8, 5,7,
                            2, 10, 11, 7, 10,
                            1.95, 7,7,7,
                            5, 10, 6, 15,
                            2, 9.25, 6, 6.5, 5.25,
                            2.03,
                            6, 6.5,
                            7,7,
                            6,7,6,
                            7, 3.5, 4.5, 7,
                            7,7, 7.5, 4,
                            5.1,
                            3,
                            9,5,
                            3,
                            4.75,3,
                            8, 1.88,
                            6, 6, 7.33, 13,
                            2.7, 10,
                            3.4
                            ))

vinto1 = df$esito*df$giocato1*df$quota
vinto2 = df$esito*df$giocato2*df$quota

df$vinto1 = vinto1
df$vinto2 = vinto2




par(mfrow=c(1,2))

# Strategia 'univ'

giocato1<- df$giocato1[!is.na(df$giocato1)]
vinto1 <- df$vinto1[!is.na(df$vinto1)]

plot(cumsum(giocato1), 100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1),
     type ="l", ylab ="% Net gain",
     xlab ="Cumulated invested money", ylim=c(-130,130),
     main = "Sistemone Torelli & Co")
abline(a=0, b=0, col="red", lty = 2)
text(x=(cumsum(giocato1))[length(cumsum(giocato1))] -65,
     y=(100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1))[length(cumsum(giocato1))]-8,
     paste(round((100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1))[length(cumsum(giocato1))],1),
           "%", sep="") )

# Strategia "Sistemone"

giocato2<- df$giocato2[!is.na(df$giocato2)]
vinto2 <- df$vinto2[!is.na(df$vinto2)]

plot(cumsum(giocato2),
     100*(cumsum(vinto2)-cumsum(giocato2))/cumsum(giocato2),
     type ="l", ylab ="% Net gain",
     xlab ="Cumulated invested money", ylim=c(-130,130),
     main = "Sistemone Pandolfi & Co")
abline(a=0, b=0, col="red", lty = 2)
text(x=(cumsum(giocato2))[length(cumsum(giocato2))] -15,
     y=(100*(cumsum(vinto2)-cumsum(giocato2))/cumsum(giocato2))[length(cumsum(giocato2))]-8,
     paste(round((100*(cumsum(vinto2)-cumsum(giocato2))/cumsum(giocato2))[length(cumsum(giocato2))],1), "%", sep="") )


pseudo_R2 <- prod(0.512, 0.466, 0.649,
                  0.292, 0.059, 0.249,
                  0.282, 0.613, 0.303,
                  0.312, 0.686, 0.624,
                  0.509, 0.28, 0.811,
                  0.748)^(1/16)

pseudo_R2_second <- prod(0.369, 0.462,0.243,
                         0.27, 0.32,0.4,
                         0.436,0.616,0.119,
                         0.244, 0.163, 0.435,
                         0.277,0.712,0.144, 0.413)^(1/16)

pseudo_R2_third <- prod(0.309, 0.767,0.402,
                        0.624,0.122, 0.18,
                        0.658, 0.436,0.26,
                        0.428, 0.175, 0.646,
                        0.153, 0.681,0.393,
                        0.041)^(1/16)

gap<- mean(0.512, 0.466, 0.649,
     0.292, 0.059, 0.249,
     0.282, 0.613, 0.303,
     0.312, 0.686, 0.624,
     0.509, 0.28, 0.811,
     0.748,
     0.369, 0.469, 0.246, 0.272)

gap_2nd <- mean(0.369, 0.462,0.243,
                0.27, 0.32,0.4,
                0.436,0.616,0.119,
                0.244, 0.163, 0.435,
                0.277,0.712,0.144, 0.413)

gap_3rd <- mean(0.309, 0.767,0.402,
                0.624,0.122, 0.18,
                0.658, 0.436,0.26,
                0.428, 0.175, 0.646,
                0.153, 0.681,0.393,
                0.041)

pseudo_R2_groupstage <- prod(c(0.512, 0.466, 0.649,
0.292, 0.059, 0.249,
0.282, 0.613, 0.303,
0.312, 0.686, 0.624,
0.509, 0.28, 0.811,
0.748 , 0.369, 0.462,0.243,
0.27, 0.32,0.4,
0.436,0.616,0.119,
0.244, 0.163, 0.435,
0.277,0.712,0.144, 0.413,
0.309, 0.767,0.402,
0.624,0.122, 0.18,
0.658, 0.436,0.26,
0.428, 0.175, 0.646,
0.153, 0.681,0.393,
0.041))^(1/48)

gap_groupstage <- mean(c(0.512, 0.466, 0.649,
                       0.292, 0.059, 0.249,
                       0.282, 0.613, 0.303,
                       0.312, 0.686, 0.624,
                       0.509, 0.28, 0.811,
                       0.748 , 0.369, 0.462,0.243,
                       0.27, 0.32,0.4,
                       0.436,0.616,0.119,
                       0.244, 0.163, 0.435,
                       0.277,0.712,0.144, 0.413,
                       0.309, 0.767,0.402,
                       0.624,0.122, 0.18,
                       0.658, 0.436,0.26,
                       0.428, 0.175, 0.646,
                       0.153, 0.681,0.393,
                       0.041))

pseudo_R2_totale <- prod(0.512, 0.466, 0.649,
                             0.292, 0.059, 0.249,
                             0.282, 0.613, 0.303,
                             0.312, 0.686, 0.624,
                             0.509, 0.28, 0.811,
                             0.748 , 0.369, 0.462,0.243,
                             0.27, 0.32,0.4,
                             0.436,0.616,0.119,
                             0.244, 0.163, 0.435,
                             0.277,0.712,0.144, 0.413,
                             0.309, 0.767,0.402,
                             0.624,0.122, 0.18,
                             0.658, 0.436,0.26,
                             0.428, 0.175, 0.646,
                             0.153, 0.681,0.393,
                             0.041,
                             0.471, 0.665, 0.620, 0.632,
                             0.288, 0.74, 0.27, 0.486,
                             0.22, 0.264, 0.273, 0.348,
                             0.573, 0.505, 0.321, 0.345 )^(1/64)


gap_totale <- mean(c(0.512, 0.466, 0.649,
                   0.292, 0.059, 0.249,
                   0.282, 0.613, 0.303,
                   0.312, 0.686, 0.624,
                   0.509, 0.28, 0.811,
                   0.748 , 0.369, 0.462,0.243,
                   0.27, 0.32,0.4,
                   0.436,0.616,0.119,
                   0.244, 0.163, 0.435,
                   0.277,0.712,0.144, 0.413,
                   0.309, 0.767,0.402,
                   0.624,0.122, 0.18,
                   0.658, 0.436,0.26,
                   0.428, 0.175, 0.646,
                   0.153, 0.681,0.393,
                   0.041,
                   0.471, 0.665, 0.620, 0.632,
                   0.288, 0.74, 0.27, 0.486,
                   0.22, 0.264, 0.273, 0.348))



## previsione vincitori


arg <- ((0.539+0.317/2)*(0.193+0.151)+(0.402+0.318/2)*(1-0.193-0.151) ) *(0.573+0.1325)  # argentina
france <- ((0.28+0.318/2)*(0.573+0.1325)+ (0.531+0.258/2)*(1-(0.573+0.1325))   )*(0.505+0.151)  # france
croatia <- ((0.211+0.258/2)*(0.505+0.151)+(0.369+0.315/2)*(1-(0.505+0.151))  )*(0.162+0.1325)  # croatia
morocco <- ( (0.145+0.317/2)*(0.573+0.1325)  +(0.317*0.315/2)*(1-(0.573+0.1325))  )*(0.193+0.151) # morocco

sum_nonnorm <- sum(arg, france, croatia, morocco)

arg/sum_nonnorm
france/sum_nonnorm
croatia/sum_nonnorm
morocco/sum_nonnorm
