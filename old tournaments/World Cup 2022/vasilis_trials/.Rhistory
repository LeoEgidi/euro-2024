df <- data.frame(match = c("Qatar-Ecuador", "England-Iran", "Senegal-Netherlands",
"Argentina Saudi-Arabia", "Denmark-Tunisia", "United States-Wales",
"Messico-Polonia", "France-Australia", "Germany-Japan",
"Morocco-Croatia", "Spain-Costa Rica", "Spain-Costa Rica",
"Portugal-Ghana", "Brazil-Serbia",
"Spain-Costa Rica", "Spain-Costa Rica", "Spain-Costa Rica",
"Belgium-Canada", "Belgium-Canada", "Belgium-Canada",
"Uruguay-South Korea",
"Switzerland-Cameroon", "Switzerland-Cameroon", "Switzerland-Cameroon",
"Uruguay-South Korea", "Uruguay-South Korea",
"Portugal-Ghana", "Brazil-Serbia"),
esito = c(1,0,1,
0,0,0,
0,0, 1,
0, 0, 0,
1, 1,
0, 0, 0,
0, 0, 1,
0,
1,0,0,
0,1,0, 1 ),
puntata1 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA), # univ
puntata2 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", NA,
"1", "1",
"1-1", "2-0", "1-0",
"1-1", "2-0", "1-0",
NA, NA,
"1-0", "0-0", "1-1",
"1-0", "0-0",
"2-0", "2-0"
), # sistemone
giocato1 = c(12, 6, 12,
6, 3,  12,
12, 3, 6,
6, 3, 6,
12,12,
NA, NA, NA,
NA, NA, NA,
6, NA,
NA, NA, NA,
NA, NA, NA),
giocato2 = c(NA, NA, 12, 12, 6,
3, 7,4,
6, 6 , 3, NA,
12, 12,
2,3,3,
3,3,3,
7,
3,3,3,
3,4,
2,2
),
quota =   c(2.25, 10, 1.57,
7, 13, 2.45,
2.7, 5, 6.75,
4, 17, 5.5,
1.4, 1.46,
19, 6, 8,
8.5, 8, 8,
5.5,
6,7,7,
7.5, 6,
6.5, 7.5
))
df <- data.frame(match = c("Qatar-Ecuador", "England-Iran", "Senegal-Netherlands",
"Argentina Saudi-Arabia", "Denmark-Tunisia", "United States-Wales",
"Messico-Polonia", "France-Australia", "Germany-Japan",
"Morocco-Croatia", "Spain-Costa Rica", "Spain-Costa Rica",
"Portugal-Ghana", "Brazil-Serbia",
"Spain-Costa Rica", "Spain-Costa Rica", "Spain-Costa Rica",
"Belgium-Canada", "Belgium-Canada", "Belgium-Canada",
"Uruguay-South Korea",
"Switzerland-Cameroon", "Switzerland-Cameroon", "Switzerland-Cameroon",
"Uruguay-South Korea", "Uruguay-South Korea",
"Portugal-Ghana", "Brazil-Serbia"),
esito = c(1,0,1,
0,0,0,
0,0, 1,
0, 0, 0,
1, 1,
0, 0, 0,
0, 0, 1,
0,
1,0,0,
0,1,0, 1 ),
puntata1 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA), # univ
puntata2 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", NA,
"1", "1",
"1-1", "2-0", "1-0",
"1-1", "2-0", "1-0",
NA, NA,
"1-0", "0-0", "1-1",
"1-0", "0-0",
"2-0", "2-0"
), # sistemone
giocato1 = c(12, 6, 12,
6, 3,  12,
12, 3, 6,
6, 3, 6,
12,12,
NA, NA, NA,
NA, NA, NA,
6,
NA, NA, NA,
NA, NA, NA),
giocato2 = c(NA, NA, 12, 12, 6,
3, 7,4,
6, 6 , 3, NA,
12, 12,
2,3,3,
3,3,3,
7,
3,3,3,
3,4,
2,2
),
quota =   c(2.25, 10, 1.57,
7, 13, 2.45,
2.7, 5, 6.75,
4, 17, 5.5,
1.4, 1.46,
19, 6, 8,
8.5, 8, 8,
5.5,
6,7,7,
7.5, 6,
6.5, 7.5
))
c(2.25, 10, 1.57,
7, 13, 2.45,
2.7, 5, 6.75,
4, 17, 5.5,
1.4, 1.46,
19, 6, 8,
8.5, 8, 8,
5.5,
6,7,7,
7.5, 6,
6.5, 7.5
)
c(1,0,1,
0,0,0,
0,0, 1,
0, 0, 0,
1, 1,
0, 0, 0,
0, 0, 1,
0,
1,0,0,
0,1,0, 1 )
c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA)
c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", NA,
"1", "1",
"1-1", "2-0", "1-0",
"1-1", "2-0", "1-0",
NA, NA,
"1-0", "0-0", "1-1",
"1-0", "0-0",
"2-0", "2-0"
)
c(12, 6, 12,
6, 3,  12,
12, 3, 6,
6, 3, 6,
12,12,
NA, NA, NA,
NA, NA, NA,
6,
NA, NA, NA,
NA, NA, NA)
esito = c(1,0,1,
0,0,0,
0,0, 1,
0, 0, 0,
1, 1,
0, 0, 0,
0, 0, 1,
0,
1,0,0,
0,1,0, 1 )
length(esito)
puntata1 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA)
puntata1 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA)
length(puntata2)
length(puntata1)
puntata2 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", NA,
"1", "1",
"1-1", "2-0", "1-0",
"1-1", "2-0", "1-0",
NA, NA,
"1-0", "0-0", "1-1",
"1-0", "0-0",
"2-0", "2-0"
)
length(puntata2)
df <- data.frame(match = c("Qatar-Ecuador", "England-Iran", "Senegal-Netherlands",
"Argentina Saudi-Arabia", "Denmark-Tunisia", "United States-Wales",
"Messico-Polonia", "France-Australia", "Germany-Japan",
"Morocco-Croatia", "Spain-Costa Rica", "Spain-Costa Rica",
"Portugal-Ghana", "Brazil-Serbia",
"Spain-Costa Rica", "Spain-Costa Rica", "Spain-Costa Rica",
"Belgium-Canada", "Belgium-Canada", "Belgium-Canada",
"Uruguay-South Korea",
"Switzerland-Cameroon", "Switzerland-Cameroon", "Switzerland-Cameroon",
"Uruguay-South Korea", "Uruguay-South Korea",
"Portugal-Ghana", "Brazil-Serbia"),
esito = c(1,0,1,
0,0,0,
0,0, 1,
0, 0, 0,
1, 1,
0, 0, 0,
0, 0, 1,
0,
1,0,0,
0,1,0, 1 ),
puntata1 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2", "X2",
"1", "1",
NA, NA, NA,
NA, NA, NA,
"2",
NA, NA, NA,
NA, NA,
NA, NA), # univ
puntata2 = c("2", "2", "2",
"X", "1-0", "1",
"1", "1-0", "2",
"1", "2",
"1", "1",
"1-1", "2-0", "1-0",
"1-1", "2-0", "1-0",
"1", "1",
"1-0", "0-0", "1-1",
"1-0", "0-0",
"2-0", "2-0"
), # sistemone
giocato1 = c(12, 6, 12,
6, 3,  12,
12, 3, 6,
6, 3, 6,
12,12,
NA, NA, NA,
NA, NA, NA,
6,
NA, NA, NA,
NA,NA,
NA, NA),
giocato2 = c(NA, NA, 12, 12, 6,
3, 7,4,
6, 6 , 3, NA,
12, 12,
2,3,3,
3,3,3,
7,
3,3,3,
3,4,
2,2
),
quota =   c(2.25, 10, 1.57,
7, 13, 2.45,
2.7, 5, 6.75,
4, 17, 5.5,
1.4, 1.46,
19, 6, 8,
8.5, 8, 8,
5.5,
6,7,7,
7.5, 6,
6.5, 7.5
))
vinto1 = df$esito*df$giocato1*df$quota
vinto2 = df$esito*df$giocato2*df$quota
df$vinto1 = vinto1
df$vinto2 = vinto2
par(mfrow=c(1,2))
giocato1<- df$giocato1[!is.na(df$giocato1)]
vinto1 <- df$vinto1[!is.na(df$vinto1)]
plot(cumsum(giocato1), 100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1),
type ="l", ylab ="% Net gain",
xlab ="Cumulated invested money", ylim=c(-130,130),
main = "Torelli & Co")
plot(cumsum(giocato1), 100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1),
type ="l", ylab ="% Net gain",
xlab ="Cumulated invested money", ylim=c(-130,130),
main = "Torelli & Co")
abline(a=0, b=0, col="red", lty = 2)
text(x=(cumsum(giocato1))[length(cumsum(giocato1))] -4,
y=(100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1))[length(cumsum(giocato1))]-8,
paste(round((100*(cumsum(vinto1)-cumsum(giocato1))/cumsum(giocato1))[length(cumsum(giocato1))],2),
"%", sep="") )
